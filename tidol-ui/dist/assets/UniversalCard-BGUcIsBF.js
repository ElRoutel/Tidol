import{R as w,r as x,j as t,M as C,N as M,u as $,p as j}from"./index-DEEaUcvV.js";import{F as v}from"./index-C5l2ZN2-.js";const P=({variant:s="compact",currentTime:i=0,duration:r=1,isPlaying:o=!1})=>{const[u,a]=x.useState([]),l=s==="compact"?5:8,h=x.useMemo(()=>!r||r===0?0:Math.min(100,i/r*100),[i,r]);return x.useEffect(()=>{const m=Array(l).fill(50);if(!o){a(m);return}a(m);const n=setInterval(()=>{a(Array.from({length:l},()=>Math.random()*40+40))},150);return()=>clearInterval(n)},[o,l]),t.jsx("div",{className:`flex items-end gap-1 ${s==="full"?"w-full h-5":"w-16 h-4"}`,"aria-label":`Audio progress: ${Math.round(h)}%`,children:Array.from({length:l}).map((m,n)=>{const e=n/l*100<=h,p=u[n]||50;return t.jsx("div",{className:`flex-1 rounded-full transition-all duration-150 ${e?"bg-primary":"bg-white/20"}`,style:{height:`${p}%`,minHeight:"20%",maxHeight:"100%"}},n)})})},N=w.memo(P),z=s=>{if(!s)return{};const i=!!s.displayTitle||s.autor||s.year||s.anio;let r=s.displayTitle||s.titulo||s.title||s.name||"Unknown";const o=typeof s.titulo=="string"&&/^\s*\d{1,2}\b/.test(s.titulo);if(s.identifier&&s.album){const a=String(s.album).trim();o?a.length>0&&(r=a):!i&&a&&a.length>r.length+5&&(r=a)}let u=s.artista||s.artist||s.creator||s.autor||"";return i&&s.year&&(u=s.year.toString()),{id:s.id||s.identifier,title:r,subtitle:u,image:s.portada||s.cover_url||s.thumbnail||s.image||"/default_cover.png",url:s.url||s.file||s.playbackUrl,type:s.type||"song",...s}},S=w.memo(({data:s,type:i="song",variant:r="shelf",onPlay:o,index:u,children:a})=>{const{currentSong:l,isPlaying:h}=C(),{currentTime:m,duration:n}=M(),{openContextMenu:b}=$(),e=x.useMemo(()=>z(s),[s]),p=!!e.displayTitle||!!e.year||!!e.autor,c=x.useMemo(()=>{if(i!=="song"||!l)return!1;const d=l.id&&e.id&&l.id===e.id,k=l.identifier&&e.identifier&&l.identifier===e.identifier;return d||k},[l,e.id,e.identifier,i]),f=x.useCallback(d=>{d.stopPropagation(),o&&o(e)},[o,e]),g=x.useCallback(d=>{d.preventDefault(),d.stopPropagation(),b(d,i,e)},[b,i,e]),y={"data-id":e.id,"data-title":e.title,"data-artist":e.subtitle,"data-cover":e.image,"data-url":e.url,"data-duration":e.duracion||e.duration,"data-album":e.album||e.album_name,"data-artist-id":e.artistId||e.artista_id,"data-album-id":e.albumId||e.album_id};return r==="shelf"?t.jsxs("div",{className:`group relative flex-shrink-0 w-36 md:w-48 flex flex-col gap-3 cursor-pointer ${i}-item`,onClick:f,onContextMenu:g,...y,children:[t.jsxs("div",{className:"relative aspect-square w-full overflow-hidden rounded-md glass-card group-hover:bg-white/10 transition-colors",children:[t.jsx("img",{src:e.image,alt:e.title,className:`w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 ${i==="artist"?"rounded-full":""}`,loading:"lazy"}),!c&&t.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:t.jsx("button",{className:"w-12 h-12 rounded-full bg-primary text-black flex items-center justify-center shadow-lg transform scale-90 group-hover:scale-100 transition-transform hover:bg-primary-hover",onClick:f,children:t.jsx(j,{size:24,className:"ml-1"})})}),c&&t.jsx("div",{className:"absolute bottom-2 left-2 right-2",children:t.jsx(N,{variant:"compact",currentTime:m,duration:n,isPlaying:h})}),t.jsx("button",{className:"absolute top-2 right-2 p-2 rounded-full bg-black/60 text-white opacity-0 group-hover:opacity-100 transition-opacity hover:bg-black/80",onClick:g,children:t.jsx(v,{size:14})})]}),t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("h3",{className:`text-sm font-bold text-white truncate ${p?"text-[14px] md:text-[16px]":""}`,children:e.title}),p?t.jsx("p",{className:"text-xs text-gray-400",children:e.year?e.year:e.subtitle}):t.jsx("p",{className:"text-xs text-text-secondary truncate",children:e.subtitle})]})]}):r==="grid"?t.jsxs("div",{className:`group relative flex items-center gap-3 p-2 rounded-md glass-card hover:bg-white/10 transition-colors cursor-pointer ${i}-item ${c?"bg-white/10 border-primary/50":""}`,onClick:f,onContextMenu:g,...y,children:[t.jsxs("div",{className:"relative w-12 h-12 flex-shrink-0",children:[t.jsx("img",{src:e.image,alt:e.title,className:"w-full h-full object-cover rounded",loading:"lazy"}),c&&t.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center rounded p-1",children:t.jsx(N,{variant:"compact",currentTime:m,duration:n,isPlaying:h})})]}),t.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[t.jsx("h4",{className:`text-sm font-semibold truncate ${c?"text-primary":"text-white"}`,children:e.title}),t.jsx("p",{className:"text-xs text-text-secondary truncate",children:e.subtitle})]}),t.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx("button",{className:"p-2 text-text-secondary hover:text-white transition-colors",onClick:g,children:t.jsx(v,{})}),t.jsx("button",{className:"w-8 h-8 rounded-full bg-primary text-black flex items-center justify-center shadow-sm hover:scale-105 transition-transform",onClick:f,children:t.jsx(j,{size:14,className:"ml-0.5"})})]})]}):r==="list"?t.jsxs("div",{className:`group flex items-center gap-4 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer ${i}-item ${c?"bg-white/10":""}`,onClick:f,onContextMenu:g,...y,children:[u!==void 0&&t.jsx("div",{className:"w-6 flex items-center justify-center",children:c?t.jsx(N,{variant:"compact",currentTime:m,duration:n,isPlaying:h}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-center text-sm text-text-secondary group-hover:hidden",children:u+1}),t.jsx("button",{className:"hidden group-hover:flex items-center justify-center text-white",onClick:f,children:t.jsx(j,{size:14})})]})}),t.jsx("img",{src:e.image,alt:e.title,className:"w-10 h-10 object-cover rounded",loading:"lazy"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:`text-sm font-medium truncate ${c?"text-primary":"text-white"}`,children:e.title}),t.jsx("p",{className:"text-xs text-text-secondary truncate",children:e.subtitle})]}),t.jsx("div",{className:"hidden md:block w-1/4 text-xs text-text-secondary truncate",children:e.album||""}),t.jsxs("div",{className:"flex items-center gap-4",children:[a,t.jsx("button",{className:"opacity-0 group-hover:opacity-100 p-2 text-text-secondary hover:text-white transition-opacity",onClick:g,children:t.jsx(v,{})}),t.jsx("span",{className:"text-xs text-text-secondary w-10 text-right",children:e.duracion?A(e.duracion):""})]})]}):null}),A=s=>{if(!s)return"";const i=Math.floor(s/60),r=Math.floor(s%60);return`${i}:${r.toString().padStart(2,"0")}`};S.displayName="UniversalCard";export{S as U};
