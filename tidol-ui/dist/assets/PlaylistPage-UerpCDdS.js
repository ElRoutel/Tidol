import{n as P,r,d as k,J as z,j as e,p as E,q as I,o as _,l as $,K as C,a as f}from"./index-DEEaUcvV.js";import{U as T}from"./UniversalCard-BGUcIsBF.js";import"./index-C5l2ZN2-.js";function L(){const{id:i}=P(),[d,x]=r.useState(null),[s,o]=r.useState([]),[p,c]=r.useState(!0),[h,g]=r.useState(null),{playSongList:m,currentSong:D}=k(),{removeSongFromPlaylist:j}=z(),[b,y]=r.useState(0);r.useEffect(()=>{i&&(async()=>{try{c(!0);try{const t=await f.get(`/playlists/${i}`);if(x(t.data),t.data.songs)o(t.data.songs);else{const l=await f.get(`/playlists/${i}/songs`);o(l.data)}}catch(t){console.warn("API fetch failed, trying local fallback",t);const l=localStorage.getItem("tidol_playlists");if(l){const n=JSON.parse(l).find(S=>S.id.toString()===i);if(n)x(n),o(n.songs||[]);else throw new Error("Playlist not found locally")}}c(!1)}catch(t){console.error("Error loading playlist:",t),g("No se pudo cargar la playlist"),c(!1)}})()},[i]),r.useEffect(()=>{if(s.length>0){const a=s.reduce((t,l)=>t+(l.duracion||l.duration||0),0);y(a)}},[s]);const v=a=>{m(s,a)},w=async(a,t)=>{a.stopPropagation(),window.confirm("Â¿Quitar canciÃ³n de la playlist?")&&await j(i,t)&&o(u=>u.filter(n=>n.id!==t))},N=a=>{if(!a)return"";const t=Math.floor(a/3600),l=Math.floor(a%3600/60);return t>0?`${t} h ${l} min`:`${l} min`};return p?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white"})}):h?e.jsx("div",{className:"flex items-center justify-center h-screen text-red-400",children:e.jsx("h2",{className:"text-xl font-bold",children:h})}):e.jsxs("div",{className:"relative min-h-screen pb-40",children:[e.jsx("div",{className:"fixed inset-0 z-0 bg-cover bg-center blur-3xl opacity-30 scale-110 pointer-events-none transition-all duration-1000",style:{backgroundImage:`url(${s[0]?.portada||s[0]?.cover_url||"/default_cover.png"})`}}),e.jsx("div",{className:"fixed inset-0 z-0 bg-gradient-to-b from-black/20 via-[#0a0a0a]/80 to-[#0a0a0a] pointer-events-none"}),e.jsxs("div",{className:"relative z-10 px-8 pt-24 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-end mb-12 animate-fade-in",children:[e.jsx("div",{className:"w-64 h-64 shadow-2xl rounded-xl overflow-hidden glass-card flex items-center justify-center bg-white/5",children:s.length>0?e.jsx("img",{src:s[0]?.portada||s[0]?.cover_url,alt:d?.nombre,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-6xl",children:"ðŸŽµ"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"uppercase tracking-widest text-xs font-bold mb-2 text-white/80",children:"Playlist"}),e.jsx("h1",{className:"text-5xl md:text-7xl font-bold text-white mb-6 tracking-tight",children:d?.nombre}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300 mb-6",children:[e.jsx("span",{className:"font-medium text-white",children:"Creado por ti"}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[s.length," canciones"]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:N(b)})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m(s,0),className:"w-14 h-14 rounded-full bg-[#1db954] hover:bg-[#1ed760] text-black flex items-center justify-center shadow-lg hover:scale-105 transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:s.length===0,children:e.jsx(E,{size:28,className:"ml-1"})}),e.jsx("button",{className:"w-10 h-10 rounded-full border border-white/20 hover:bg-white/10 flex items-center justify-center text-white transition-all",children:e.jsx(I,{size:20})}),e.jsx("button",{className:"w-10 h-10 rounded-full border border-white/20 hover:bg-white/10 flex items-center justify-center text-white transition-all",children:e.jsx(_,{size:20})})]})]})]}),e.jsxs("div",{className:"glass-card rounded-xl overflow-hidden animate-slide-up",children:[e.jsxs("div",{className:"grid grid-cols-[auto_1fr_auto_auto] gap-4 px-6 py-3 border-b border-white/5 text-sm text-gray-400 font-medium uppercase tracking-wider",children:[e.jsx("div",{className:"w-8 text-center",children:"#"}),e.jsx("div",{children:"TÃ­tulo"}),e.jsx("div",{className:"hidden md:block",children:e.jsx($,{size:18})}),e.jsx("div",{className:"w-8"})]}),s.length===0?e.jsxs("div",{className:"text-center py-16 text-gray-500",children:[e.jsx("p",{className:"text-lg mb-2",children:"Esta playlist estÃ¡ vacÃ­a"}),e.jsx("p",{className:"text-sm",children:"Agrega canciones desde el menÃº contextual"})]}):s.map((a,t)=>e.jsx(T,{data:a,type:"song",variant:"list",index:t,onPlay:()=>v(t),children:e.jsx("button",{className:"text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity p-2",onClick:l=>w(l,a.id),title:"Quitar de playlist",children:e.jsx(C,{size:18})})},a.id||t))]})]})]})}export{L as default};
