import{r as l,e as v,j as s,a as r}from"./index-DEEaUcvV.js";function w(){const[u,m]=l.useState(null),[p,d]=l.useState(null),[c,h]=l.useState(null),[n,g]=l.useState(""),[x,i]=l.useState(""),[N,b]=l.useState([]),[S,f]=l.useState([]),{token:C}=v();l.useEffect(()=>{(async()=>{try{const t=await r.get("/albumes");f(t.data)}catch(t){console.error("Error fetching albums:",t)}})()},[]);const j=async e=>{if(e.preventDefault(),i("Subiendo..."),b([]),!u||u.length===0){i("❌ Selecciona al menos una canción");return}if(S.some(a=>a.titulo?.toLowerCase()===n.toLowerCase())){i("❌ El álbum ya existe.");return}const t=new FormData;for(let a=0;a<u.length;a++)t.append("song",u[a]);if(p&&t.append("coverFile",p),n&&t.append("albumName",n),c)for(let a=0;a<c.length;a++)t.append("lyrics",c[a]);try{const o=(await r.post("/uploads/musica",t,{headers:{"Content-Type":"multipart/form-data"}})).data;if(o.error)i(`❌ ${o.error}`);else{i(`✅ ${o.message}`),g(""),m(null),d(null),h(null),e.target.reset(),b(o.canciones||[]);const y=await r.get("/albumes");f(y.data)}}catch(a){console.error(a),i("❌ Error al subir canciones. Revisa la consola.")}};return s.jsxs("section",{className:"music-upload-container",children:[s.jsx("h2",{className:"music-upload-title",children:"Subir Canciones/Álbumes"}),s.jsxs("form",{className:"music-upload-form glass-card",onSubmit:j,children:[s.jsx("input",{type:"file",className:"music-upload-input-file music-upload-songs-input",name:"song",multiple:!0,accept:".mp3,.wav,.ogg,.flac,.alac",onChange:e=>m(e.target.files),required:!0}),s.jsx("input",{type:"file",className:"music-upload-input-file music-upload-cover-input",name:"coverFile",accept:"image/*",onChange:e=>d(e.target.files[0])}),s.jsx("input",{type:"text",className:"music-upload-input-text music-upload-album-input",name:"albumName",placeholder:"Nombre del álbum",value:n,onChange:e=>g(e.target.value),required:!0}),s.jsx("button",{type:"submit",className:"music-upload-submit-btn",children:"Subir"})]}),s.jsx("p",{className:"music-upload-status glass-card",children:x}),s.jsx("div",{className:"music-upload-songs-grid",children:N.map(e=>s.jsxs("div",{className:"music-upload-song-card glass-card",children:[s.jsx("strong",{className:"music-upload-song-title",children:e.titulo}),s.jsxs("span",{className:"music-upload-song-artist",children:[e.artista," (",e.album,")"]}),s.jsxs("small",{className:"music-upload-song-quality",children:["Calidad: ",e.bitDepth,"-bit ",e.sampleRate/1e3," kHz"]})]},e.id))})]})}export{w as UploadPage};
