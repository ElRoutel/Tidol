import{d as u,r as i}from"./index-DEEaUcvV.js";function d(){const{playSongList:e}=u(),r=i.useCallback(a=>{if(!a.url){console.warn("âš ï¸  CanciÃ³n sin URL, saltando descarga:",a.titulo);return}if(a.url.startsWith("/uploads/")||a.url.startsWith("http://localhost")){console.log("ðŸ’¾ CanciÃ³n ya estÃ¡ en cachÃ© local:",a.titulo);return}if(!a.url.startsWith("http://")&&!a.url.startsWith("https://")){console.warn("âš ï¸  URL invÃ¡lida, saltando descarga:",a.url);return}a.url.includes("archive.org")||console.warn("âš ï¸  URL no es de Internet Archive:",a.url),fetch("/spectra/ingest-remote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audioUrl:a.url,coverUrl:a.portada||null,metadata:{title:a.titulo||a.title,artist:a.artista||a.artist||"Unknown",album:a.album||"Internet Archive",ia_id:a.identifier||(a.type==="ia",a.id),duration:a.duracion||a.duration||0}})}).then(t=>t.json()).then(t=>{t.success?t.alreadyExists?console.log("ðŸ’¾ CanciÃ³n ya estaba en cachÃ©:",a.titulo):console.log("ðŸ“¥ Descarga iniciada:",a.titulo,`(Track ID: ${t.trackId})`):console.warn("âš ï¸  Backend respondiÃ³ con error:",t.error)}).catch(t=>{console.warn("âš ï¸  No se pudo cachear la canciÃ³n:",t.message)})},[]),c=i.useCallback(async a=>{if(!a||!a.url){console.error("âŒ useLazyCaching: CanciÃ³n invÃ¡lida o sin URL");return}e([a],0),console.log("â–¶ï¸  ReproducciÃ³n iniciada:",a.titulo),r(a)},[e,r]),n=i.useCallback((a,l=0)=>{!a||a.length===0||(e(a,l),a.forEach((t,o)=>{setTimeout(()=>{r(t)},o*1e3)}))},[e,r]);return{handlePlayTrack:c,handlePlayList:n}}export{d as u};
