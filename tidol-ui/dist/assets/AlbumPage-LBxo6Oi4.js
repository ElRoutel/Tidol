import{n as P,h as A,r as d,d as I,u as $,j as e,A as M,o as f,L as D,p as E,q as R,l as q,a as b}from"./index-DEEaUcvV.js";function H(){const{id:n}=P(),[g]=A(),c=g.get("song"),[s,j]=d.useState(null),[m,w]=d.useState([]),[v,x]=d.useState(!0),[p,N]=d.useState(null),[B,y]=d.useState(new Set),{playSongList:u,currentSong:k}=I(),{openContextMenu:h}=$(),[T,S]=d.useState(0);d.useEffect(()=>{n&&(async()=>{try{x(!0);try{const i=await b.get("/music/songs/likes");i.data&&y(new Set(i.data.map(l=>l.id)))}catch{console.log("No logueado o error likes")}const a=await b.get(`/music/albums/${n}`);j(a.data);const r=await b.get(`/music/albums/${n}/songs`);w(r.data);const o=r.data.reduce((i,l)=>i+(l.duracion||0),0);if(S(o),c&&r.data.length>0){const i=r.data.findIndex(l=>l.id==c);i!==-1&&u(r.data,i)}x(!1)}catch(a){console.error("Error cargando álbum:",a),N("No se pudo cargar el álbum"),x(!1)}})()},[n,c]);const C=t=>{u(m,t)},_=(t,a)=>{t.stopPropagation();const r={id:a.id,titulo:a.titulo,artista:a.artista,album:s?.titulo,portada:s?.portada,duracion:a.duracion,url:a.url||a.filepath};h(t,"song",r)},z=t=>t.bit_depth===24||t.bit_depth===32?"Hi-Res":t.format&&t.format.toLowerCase().includes("flac")?"FLAC":null,L=t=>{if(!t)return"--:--";const a=Math.floor(t/60),r=Math.floor(t%60);return`${a}:${r.toString().padStart(2,"0")}`};return v?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white"})}):p?e.jsx("div",{className:"flex items-center justify-center h-screen text-red-400",children:e.jsx("h2",{className:"text-xl font-bold",children:p})}):e.jsxs("div",{className:"relative min-h-screen pb-40",children:[e.jsx("div",{className:"fixed inset-0 z-0",children:e.jsx(M,{songId:s?.id,colors:s?.extractedColors,intensity:.5})}),e.jsx("div",{className:"fixed inset-0 z-0 bg-gradient-to-b from-black/20 via-[#0a0a0a]/80 to-[#0a0a0a] pointer-events-none"}),e.jsxs("div",{className:"fixed top-0 left-0 w-full z-50 flex justify-between items-center px-4 py-4 md:hidden bg-transparent",children:[e.jsx("button",{onClick:()=>window.history.back(),className:"w-10 h-10 rounded-full bg-black/20 backdrop-blur-md flex items-center justify-center text-white",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})})}),e.jsx("button",{onClick:t=>h&&h(t,"album",s),className:"w-10 h-10 rounded-full bg-black/20 backdrop-blur-md flex items-center justify-center text-white",children:e.jsx(f,{size:24})})]}),e.jsxs("div",{className:"relative z-10 px-6 pt-20 md:pt-24 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 md:gap-8 items-center md:items-end mb-8 md:mb-12 animate-fade-in text-center md:text-left",children:[e.jsx("div",{className:"w-[60vw] max-w-[250px] aspect-square shadow-2xl rounded-xl overflow-hidden glass-card flex items-center justify-center bg-white/5 mx-auto md:mx-0",children:e.jsx("img",{src:s?.coverFull||s?.portada||"/default_cover.png",alt:s?.titulo,className:"w-full h-full object-cover",loading:"lazy"})}),e.jsxs("div",{className:"flex-1 min-w-0 w-full",children:[e.jsx("h5",{className:"hidden md:block uppercase tracking-widest text-xs font-bold mb-2 text-white/60",children:"Álbum"})," ",e.jsx("h1",{className:"text-2xl md:text-7xl font-bold text-white mb-2 md:mb-6 tracking-tight line-clamp-3 leading-tight px-4 md:px-0",children:s?.titulo}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-center gap-1 md:gap-2 mb-8 md:mb-6 justify-center md:justify-start",children:[s?.artista_id?e.jsx(D,{to:`/artist/${s.artista_id}`,className:"text-xl md:text-xl font-bold text-[#1db954] hover:underline w-fit",children:s?.autor||"Desconocido"}):e.jsx("span",{className:"text-xl md:text-xl font-bold text-[#1db954] w-fit",children:s?.autor||"Desconocido"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400/80 font-medium mt-1 md:mt-0",children:[e.jsx("span",{className:"hidden md:inline",children:"•"}),e.jsx("span",{className:"uppercase tracking-wide",children:s?.genre||"Música"}),e.jsx("span",{children:"•"}),e.jsx("span",{children:s?.year||"2024"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 w-full md:w-auto md:flex md:items-center md:gap-4 mb-2 md:my-0",children:[e.jsxs("button",{onClick:()=>u(m,0),className:"h-[50px] md:h-14 md:w-14 rounded-full bg-[#1db954] hover:bg-[#1ed760] text-black md:text-black font-semibold text-base md:text-lg flex items-center justify-center shadow-lg hover:scale-105 transition-all",children:[e.jsx(E,{size:22,className:"mr-1 md:ml-1 md:mr-0"}),e.jsx("span",{className:"md:hidden",children:"Reproducir"})]}),e.jsxs("button",{className:"h-[50px] md:h-10 md:w-10 rounded-full bg-white/10 hover:bg-white/20 text-[#1db954] md:text-white font-semibold text-base flex items-center justify-center backdrop-blur-md transition-all border-none md:border md:border-white/20",children:[e.jsx(R,{size:20,className:"mr-2 md:mr-0"}),e.jsx("span",{className:"md:hidden",children:"Aleatorio"})]}),e.jsx("button",{className:"hidden md:flex w-10 h-10 rounded-full border border-white/20 hover:bg-white/10 items-center justify-center text-white transition-all",children:e.jsx(f,{size:20})})]})]})]}),e.jsxs("div",{className:"glass-card md:rounded-xl overflow-hidden animate-slide-up bg-transparent shadow-none border-none md:bg-white/5 md:shadow-xl md:border md:border-white/5",children:[e.jsxs("div",{className:"hidden md:grid grid-cols-[auto_1fr_auto_auto_auto] gap-4 px-6 py-3 border-b border-white/5 text-sm text-gray-400 font-medium uppercase tracking-wider",children:[e.jsx("div",{className:"w-8 text-center",children:"#"}),e.jsx("div",{children:"Título"}),e.jsx("div",{className:"text-right",children:"Calidad"}),e.jsx("div",{className:"text-right",children:e.jsx(q,{size:18})}),e.jsx("div",{className:"w-8"})]}),e.jsx("div",{className:"flex flex-col pb-4 md:pb-0",children:m.map((t,a)=>{const r=k?.id===t.id,o=z(t);return e.jsxs("div",{className:`group relative grid grid-cols-[32px_1fr_40px] md:grid-cols-[auto_1fr_auto_auto_auto] gap-3 md:gap-4 px-0 md:px-6 py-2 md:py-3 items-center hover:bg-white/5 transition-colors cursor-pointer min-h-[64px] border-b border-white/5 md:border-b-0 ${r?"bg-white/10 rounded-lg md:rounded-none":""}`,onClick:()=>C(a),children:[e.jsx("div",{className:"text-left md:text-center text-gray-500 font-medium text-sm md:w-8 pl-1 md:pl-0",children:e.jsx("span",{className:`block ${r?"text-[#1db954]":""}`,children:a+1})}),e.jsxs("div",{className:"min-w-0 flex flex-col justify-center",children:[e.jsx("div",{className:`text-[16px] font-medium leading-tight truncate mb-0.5 ${r?"text-[#1db954]":"text-white"}`,children:t.titulo}),e.jsx("div",{className:"hidden md:block text-[14px] text-gray-400 truncate font-normal",children:t.artista})]}),e.jsx("div",{className:"hidden md:flex justify-end",children:o&&e.jsx("span",{className:"text-[10px] font-bold px-1.5 py-0.5 rounded border border-white/30 text-white/70 uppercase tracking-wider",children:o})}),e.jsx("div",{className:"hidden md:block text-sm text-gray-400 font-variant-numeric tabular-nums text-right",children:L(t.duracion)}),e.jsx("div",{className:"flex items-center justify-end",onClick:i=>i.stopPropagation(),children:e.jsx("button",{className:"p-3 text-gray-400 hover:text-white transition-colors",onClick:i=>_(i,t),children:e.jsx(f,{size:20})})})]},t.id)})})]})]})]})}export{H as default};
